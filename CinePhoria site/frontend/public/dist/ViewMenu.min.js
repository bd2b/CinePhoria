"use strict";var g=function(n,t,e,o){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function r(d){try{m(o.next(d))}catch(b){a(b)}}function l(d){try{m(o.throw(d))}catch(b){a(b)}}function m(d){d.done?s(d.value):i(d.value).then(r,l)}m((o=o.apply(n,t||[])).next())})};import{userDataController as v,ProfilUtilisateur as p}from"./DataControllerUser.js";import{login as k,logout as f}from"./Login.js";import{onClickContact as _}from"./ViewContact.js";export function chargerMenu(){return g(this,void 0,void 0,function*(){console.log("===== chargerMenu");const n=v.profil();console.log("Profil charge depuis global= ",n);const t=document.querySelector(".header");if(!t){console.warn("Aucun \xE9l\xE9ment .header trouv\xE9");return}const e=document.querySelector(".nav__logo-img");switch(n){case p.Visiteur:h(),t.style.background="linear-gradient(90deg, #F8F8FF 0%, #999999 100%)";break;case p.Utilisateur:{if(!localStorage.getItem("jwtAccessToken")){v.invalidate(),window.location.href="visiteur.html";return}F(),t.style.background="linear-gradient(90deg, #F8F8FF 0%, rgba(218, 165, 32, 0.25) 100%)";break}case p.Administrateur:{if(!localStorage.getItem("jwtAccessToken")){v.invalidate(),window.location.href="visiteur.html";return}E(),t.style.background="linear-gradient(90deg, #F8F8FF 0%, rgba(178, 34, 34, 0.3) 100%)",e||console.error("Pas de logo"),e.src="assets/camera-cinephoria-admin.png";break}case p.Employee:{if(!localStorage.getItem("jwtAccessToken")){v.invalidate(),window.location.href="visiteur.html";return}L(),t.style.background="linear-gradient(90deg, #F8F8FF 0%, rgba(34, 139, 34, 0.25) 100%)",e||console.error("Pas de logo"),e.src="assets/camera-cinephoria-employe.png";break}default:console.error("Profil inconnu, on consid\xE8re Visiteur"),h(),t.style.background="linear-gradient(90deg, #F8F8FF 0%, #999999 100%)";break}})}function h(){const n=document.querySelector(".nav__actions"),t=document.querySelector(".mobile-menu__nav");if(!n||!t)return;n.innerHTML="",t.innerHTML="";const e=u("R\xE9servation","reservation.html"),o=u("Films","films.html"),i=u("Contact","#");i.addEventListener("click",a=>{a.preventDefault(),_()});const s=document.createElement("button");s.classList.add("nav__actions-button","nav__actions-button--signin"),s.textContent="Connexion",s.addEventListener("click",()=>{k("Saisissez votre email et votre mot de passe",!0)}),n.append(e,o,i,s),t.append(e.cloneNode(!0),o.cloneNode(!0),i.cloneNode(!0),s.cloneNode(!0))}function F(){const n=document.querySelector(".nav__actions"),t=document.querySelector(".mobile-menu__nav");if(!n||!t)return;n.innerHTML="",t.innerHTML="";const e=u("Mes R\xE9servations","mesreservations.html"),o=u("Reservation","reservation.html"),i=u("Films","films.html"),s=u("Contact","#");s.addEventListener("click",l=>{l.preventDefault(),_()});const a=y(),r=document.createElement("button");r.classList.add("nav__actions-button","nav__actions-button--signin"),r.textContent=a,r.addEventListener("click",()=>g(this,void 0,void 0,function*(){yield f()})),n.append(e,o,i,s,r),t.append(e.cloneNode(!0),o.cloneNode(!0),i.cloneNode(!0),s.cloneNode(!0),r.cloneNode(!0))}function E(){const n=document.querySelector(".nav__actions"),t=document.querySelector(".mobile-menu__nav");if(!n||!t)return;n.innerHTML="",t.innerHTML="";const e=w(),o=y(),i=document.createElement("button");i.classList.add("nav__actions-button","nav__actions-button--signin"),i.textContent=o,i.addEventListener("click",()=>{f()}),n.append(e,i),t.append(e.cloneNode(!0),i.cloneNode(!0))}function L(){const n=document.querySelector(".nav__actions"),t=document.querySelector(".mobile-menu__nav");if(!n||!t)return;n.innerHTML="",t.innerHTML="";const e=x(),o=y(),i=document.createElement("button");i.classList.add("nav__actions-button","nav__actions-button--signin"),i.textContent=o,i.addEventListener("click",()=>{f()}),n.append(e,i),t.append(e.cloneNode(!0),i.cloneNode(!0))}function w(){const n=document.createElement("div");n.style.position="relative";const t=document.createElement("button");t.textContent="Intranet",t.classList.add("nav__actions-button","nav__actions-button--link");const e=document.createElement("div");e.style.display="none",e.style.position="absolute",e.style.zIndex="1000",e.style.top="100%",e.style.left="0",e.style.backgroundColor="#F8F8FF",e.style.border="1px solid #999";const o=c("Mod\xE9rer les avis","manageAvis.html"),i=c("G\xE9rer les films","manageFilms.html"),s=c("G\xE9rer les salles","manageSalles.html"),a=c("G\xE9rer les comptes employ\xE9s","manageEmployes.html"),r=c("Dashboard","dashboard.html");return e.append(o,i,s,a,r),t.addEventListener("mouseover",()=>{e.style.display="block"}),t.addEventListener("mouseout",l=>{const m=l.relatedTarget;e.contains(m)||(e.style.display="none")}),e.addEventListener("mouseleave",()=>{e.style.display="none"}),n.append(t,e),n}function x(){const n=document.createElement("div");n.style.position="relative";const t=document.createElement("button");t.textContent="Intranet",t.classList.add("nav__actions-button","nav__actions-button--link");const e=document.createElement("div");e.style.display="none",e.style.position="absolute",e.style.zIndex="1000",e.style.top="100%",e.style.left="0",e.style.backgroundColor="#F8F8FF",e.style.border="1px solid #999";const o=c("G\xE9rer les films","manageFilms.html"),i=c("G\xE9rer les salles","manageSalles.html"),s=c("G\xE9rer les s\xE9ances","manageSeances.html"),a=c("Moderer les avis","manageAvis.html");return e.append(o,i,s,a),t.addEventListener("mouseover",()=>{e.style.display="block"}),t.addEventListener("mouseout",r=>{const l=r.relatedTarget;e.contains(l)||(e.style.display="none")}),e.addEventListener("mouseleave",()=>{e.style.display="none"}),n.append(t,e),n}function u(n,t){const e=document.createElement("a");return e.classList.add("nav__actions-button","nav__actions-button--link"),e.textContent=n,e.href=t,e}function y(){const n=v.compte(),t=n?.utilisateurDisplayName||"??",e=t.trim().split(" ");let o="";return e.forEach(i=>{i.length>0&&(o+=i[0].toUpperCase())}),o.length===0&&(o=t.slice(0,2).toUpperCase()),o==="?"&&(o="D\xE9connexion"),o}function c(n,t){const e=document.createElement("div");e.classList.add("submenu-level2-item");const o=document.createElement("a");return o.href=t,o.textContent=n,o.style.textDecoration="none",o.style.color="#000000",e.appendChild(o),e}
